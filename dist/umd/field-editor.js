!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).ArticulateFieldEditor=t()}(this,(function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?r(Object(o),!0).forEach((function(n){t(e,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,l=void 0;try{for(var _,i=e[Symbol.iterator]();!(r=(_=i.next()).done)&&(n.push(_.value),!t||n.length!==t);r=!0);}catch(e){o=!0,l=e}finally{try{r||null==i.return||i.return()}finally{if(o)throw l}}return n}(e,t)||u(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a,f,s,p,d,h,y={},v=[],m=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function b(e,t){for(var n in t)e[n]=t[n];return e}function g(e){var t=e.parentNode;t&&t.removeChild(e)}function w(e,t,n){var r,o,l,_=arguments,i={};for(l in t)"key"==l?r=t[l]:"ref"==l?o=t[l]:i[l]=t[l];if(arguments.length>3)for(n=[n],l=3;l<arguments.length;l++)n.push(_[l]);if(null!=n&&(i.children=n),"function"==typeof e&&null!=e.defaultProps)for(l in e.defaultProps)void 0===i[l]&&(i[l]=e.defaultProps[l]);return k(e,i,r,o,null)}function k(e,t,n,r,o){var l={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==o?++a.__v:o};return null!=a.vnode&&a.vnode(l),l}function x(e){return e.children}function S(e,t){this.props=e,this.context=t}function O(e,t){if(null==t)return e.__?O(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?O(e):null}function j(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return j(e)}}function P(e){(!e.__d&&(e.__d=!0)&&f.push(e)&&!C.__r++||p!==a.debounceRendering)&&((p=a.debounceRendering)||s)(C)}function C(){for(var e;C.__r=f.length;)e=f.sort((function(e,t){return e.__v.__b-t.__v.__b})),f=[],e.some((function(e){var t,n,r,o,l,_,i;e.__d&&(_=(l=(t=e).__v).__e,(i=t.__P)&&(n=[],(r=b({},l)).__v=l.__v+1,o=U(i,l,r,t.__n,void 0!==i.ownerSVGElement,null!=l.__h?[_]:null,n,null==_?O(l):_,l.__h),I(n,l),o!=_&&j(l)))}))}function A(e,t,n,r,o,l,_,i,u,c){var a,f,s,p,d,h,m,b=r&&r.__k||v,w=b.length;for(u==y&&(u=null!=_?_[0]:w?O(r,0):null),n.__k=[],a=0;a<t.length;a++)if(null!=(p=n.__k[a]=null==(p=t[a])||"boolean"==typeof p?null:"string"==typeof p||"number"==typeof p?k(null,p,null,null,p):Array.isArray(p)?k(x,{children:p},null,null,null):null!=p.__e||null!=p.__c?k(p.type,p.props,p.key,null,p.__v):p)){if(p.__=n,p.__b=n.__b+1,null===(s=b[a])||s&&p.key==s.key&&p.type===s.type)b[a]=void 0;else for(f=0;f<w;f++){if((s=b[f])&&p.key==s.key&&p.type===s.type){b[f]=void 0;break}s=null}d=U(e,p,s=s||y,o,l,_,i,u,c),(f=p.ref)&&s.ref!=f&&(m||(m=[]),s.ref&&m.push(s.ref,null,p),m.push(f,p.__c||d,p)),null!=d?(null==h&&(h=d),u=E(e,p,s,b,_,d,u),c||"option"!=n.type?"function"==typeof n.type&&(n.__d=u):e.value=""):u&&s.__e==u&&u.parentNode!=e&&(u=O(s))}if(n.__e=h,null!=_&&"function"!=typeof n.type)for(a=_.length;a--;)null!=_[a]&&g(_[a]);for(a=w;a--;)null!=b[a]&&W(b[a],b[a]);if(m)for(a=0;a<m.length;a++)L(m[a],m[++a],m[++a])}function E(e,t,n,r,o,l,_){var i,u,c;if(void 0!==t.__d)i=t.__d,t.__d=void 0;else if(o==n||l!=_||null==l.parentNode)e:if(null==_||_.parentNode!==e)e.appendChild(l),i=null;else{for(u=_,c=0;(u=u.nextSibling)&&c<r.length;c+=2)if(u==l)break e;e.insertBefore(l,_),i=_}return void 0!==i?i:l.nextSibling}function T(e,t,n){"-"===t[0]?e.setProperty(t,n):e[t]=null==n?"":"number"!=typeof n||m.test(t)?n:n+"px"}function H(e,t,n,r,o){var l,_,i;if(o&&"className"==t&&(t="class"),"style"===t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof r&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||T(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||T(e.style,t,n[t])}else"o"===t[0]&&"n"===t[1]?(l=t!==(t=t.replace(/Capture$/,"")),(_=t.toLowerCase())in e&&(t=_),t=t.slice(2),e.l||(e.l={}),e.l[t+l]=n,i=l?N:F,n?r||e.addEventListener(t,i,l):e.removeEventListener(t,i,l)):"list"!==t&&"tagName"!==t&&"form"!==t&&"type"!==t&&"size"!==t&&"download"!==t&&"href"!==t&&!o&&t in e?e[t]=null==n?"":n:"function"!=typeof n&&"dangerouslySetInnerHTML"!==t&&(t!==(t=t.replace(/xlink:?/,""))?null==n||!1===n?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),n):null==n||!1===n&&!/^ar/.test(t)?e.removeAttribute(t):e.setAttribute(t,n))}function F(e){this.l[e.type+!1](a.event?a.event(e):e)}function N(e){this.l[e.type+!0](a.event?a.event(e):e)}function D(e,t,n){var r,o;for(r=0;r<e.__k.length;r++)(o=e.__k[r])&&(o.__=e,o.__e&&("function"==typeof o.type&&o.__k.length>1&&D(o,t,n),t=E(n,o,o,e.__k,null,o.__e,t),"function"==typeof e.type&&(e.__d=t)))}function U(e,t,n,r,o,l,_,i,u){var c,f,s,p,d,h,y,v,m,g,w,k=t.type;if(void 0!==t.constructor)return null;null!=n.__h&&(u=n.__h,i=t.__e=n.__e,t.__h=null,l=[i]),(c=a.__b)&&c(t);try{e:if("function"==typeof k){if(v=t.props,m=(c=k.contextType)&&r[c.__c],g=c?m?m.props.value:c.__:r,n.__c?y=(f=t.__c=n.__c).__=f.__E:("prototype"in k&&k.prototype.render?t.__c=f=new k(v,g):(t.__c=f=new S(v,g),f.constructor=k,f.render=q),m&&m.sub(f),f.props=v,f.state||(f.state={}),f.context=g,f.__n=r,s=f.__d=!0,f.__h=[]),null==f.__s&&(f.__s=f.state),null!=k.getDerivedStateFromProps&&(f.__s==f.state&&(f.__s=b({},f.__s)),b(f.__s,k.getDerivedStateFromProps(v,f.__s))),p=f.props,d=f.state,s)null==k.getDerivedStateFromProps&&null!=f.componentWillMount&&f.componentWillMount(),null!=f.componentDidMount&&f.__h.push(f.componentDidMount);else{if(null==k.getDerivedStateFromProps&&v!==p&&null!=f.componentWillReceiveProps&&f.componentWillReceiveProps(v,g),!f.__e&&null!=f.shouldComponentUpdate&&!1===f.shouldComponentUpdate(v,f.__s,g)||t.__v===n.__v){f.props=v,f.state=f.__s,t.__v!==n.__v&&(f.__d=!1),f.__v=t,t.__e=n.__e,t.__k=n.__k,f.__h.length&&_.push(f),D(t,i,e);break e}null!=f.componentWillUpdate&&f.componentWillUpdate(v,f.__s,g),null!=f.componentDidUpdate&&f.__h.push((function(){f.componentDidUpdate(p,d,h)}))}f.context=g,f.props=v,f.state=f.__s,(c=a.__r)&&c(t),f.__d=!1,f.__v=t,f.__P=e,c=f.render(f.props,f.state,f.context),f.state=f.__s,null!=f.getChildContext&&(r=b(b({},r),f.getChildContext())),s||null==f.getSnapshotBeforeUpdate||(h=f.getSnapshotBeforeUpdate(p,d)),w=null!=c&&c.type==x&&null==c.key?c.props.children:c,A(e,Array.isArray(w)?w:[w],t,n,r,o,l,_,i,u),f.base=t.__e,t.__h=null,f.__h.length&&_.push(f),y&&(f.__E=f.__=null),f.__e=!1}else null==l&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=M(n.__e,t,n,r,o,l,_,u);(c=a.diffed)&&c(t)}catch(e){t.__v=null,(u||null!=l)&&(t.__e=i,t.__h=!!u,l[l.indexOf(i)]=null),a.__e(e,t,n)}return t.__e}function I(e,t){a.__c&&a.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){a.__e(e,t.__v)}}))}function M(e,t,n,r,o,l,_,i){var u,c,a,f,s,p=n.props,d=t.props;if(o="svg"===t.type||o,null!=l)for(u=0;u<l.length;u++)if(null!=(c=l[u])&&((null===t.type?3===c.nodeType:c.localName===t.type)||e==c)){e=c,l[u]=null;break}if(null==e){if(null===t.type)return document.createTextNode(d);e=o?document.createElementNS("http://www.w3.org/2000/svg",t.type):document.createElement(t.type,d.is&&{is:d.is}),l=null,i=!1}if(null===t.type)p===d||i&&e.data===d||(e.data=d);else{if(null!=l&&(l=v.slice.call(e.childNodes)),a=(p=n.props||y).dangerouslySetInnerHTML,f=d.dangerouslySetInnerHTML,!i){if(null!=l)for(p={},s=0;s<e.attributes.length;s++)p[e.attributes[s].name]=e.attributes[s].value;(f||a)&&(f&&(a&&f.__html==a.__html||f.__html===e.innerHTML)||(e.innerHTML=f&&f.__html||""))}(function(e,t,n,r,o){var l;for(l in n)"children"===l||"key"===l||l in t||H(e,l,null,n[l],r);for(l in t)o&&"function"!=typeof t[l]||"children"===l||"key"===l||"value"===l||"checked"===l||n[l]===t[l]||H(e,l,t[l],n[l],r)})(e,d,p,o,i),f?t.__k=[]:(u=t.props.children,A(e,Array.isArray(u)?u:[u],t,n,r,"foreignObject"!==t.type&&o,l,_,y,i)),i||("value"in d&&void 0!==(u=d.value)&&(u!==e.value||"progress"===t.type&&!u)&&H(e,"value",u,p.value,!1),"checked"in d&&void 0!==(u=d.checked)&&u!==e.checked&&H(e,"checked",u,p.checked,!1))}return e}function L(e,t,n){try{"function"==typeof e?e(t):e.current=t}catch(e){a.__e(e,n)}}function W(e,t,n){var r,o,l;if(a.unmount&&a.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||L(r,null,t)),n||"function"==typeof e.type||(n=null!=(o=e.__e)),e.__e=e.__d=void 0,null!=(r=e.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(e){a.__e(e,t)}r.base=r.__P=null}if(r=e.__k)for(l=0;l<r.length;l++)r[l]&&W(r[l],t,n);null!=o&&g(o)}function q(e,t,n){return this.constructor(e,n)}function z(e,t,n){var r,o,l;a.__&&a.__(e,t),o=(r=n===d)?null:n&&n.__k||t.__k,e=w(x,null,[e]),l=[],U(t,(r?t:n||t).__k=e,o||y,y,void 0!==t.ownerSVGElement,n&&!r?[n]:o?null:t.childNodes.length?v.slice.call(t.childNodes):null,l,n||y,r),I(l,e)}a={__e:function(e,t){for(var n,r,o,l=t.__h;t=t.__;)if((n=t.__c)&&!n.__)try{if((r=n.constructor)&&null!=r.getDerivedStateFromError&&(n.setState(r.getDerivedStateFromError(e)),o=n.__d),null!=n.componentDidCatch&&(n.componentDidCatch(e),o=n.__d),o)return t.__h=l,n.__E=n}catch(t){e=t}throw e},__v:0},S.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=b({},this.state),"function"==typeof e&&(e=e(b({},n),this.props)),e&&b(n,e),null!=e&&this.__v&&(t&&this.__h.push(t),P(this))},S.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),P(this))},S.prototype.render=x,f=[],s="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,C.__r=0,d=y,h=0;var R,V,B,$=0,G=[],J=a.__b,K=a.__r,Q=a.diffed,X=a.__c,Y=a.unmount;function Z(e,t){a.__h&&a.__h(V,e,$||t),$=0;var n=V.__H||(V.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function ee(e){return $=1,function(e,t,n){var r=Z(R++,2);return r.t=e,r.__c||(r.__=[n?n(t):le(void 0,t),function(e){var t=r.t(r.__[0],e);r.__[0]!==t&&(r.__=[t,r.__[1]],r.__c.setState({}))}],r.__c=V),r.__}(le,e)}function te(){G.forEach((function(e){if(e.__P)try{e.__H.__h.forEach(re),e.__H.__h.forEach(oe),e.__H.__h=[]}catch(t){e.__H.__h=[],a.__e(t,e.__v)}})),G=[]}a.__b=function(e){V=null,J&&J(e)},a.__r=function(e){K&&K(e),R=0;var t=(V=e.__c).__H;t&&(t.__h.forEach(re),t.__h.forEach(oe),t.__h=[])},a.diffed=function(e){Q&&Q(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(1!==G.push(t)&&B===a.requestAnimationFrame||((B=a.requestAnimationFrame)||function(e){var t,n=function(){clearTimeout(r),ne&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);ne&&(t=requestAnimationFrame(n))})(te)),V=void 0},a.__c=function(e,t){t.some((function(e){try{e.__h.forEach(re),e.__h=e.__h.filter((function(e){return!e.__||oe(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],a.__e(n,e.__v)}})),X&&X(e,t)},a.unmount=function(e){Y&&Y(e);var t=e.__c;if(t&&t.__H)try{t.__H.__.forEach(re)}catch(e){a.__e(e,t.__v)}};var ne="function"==typeof requestAnimationFrame;function re(e){var t=V;"function"==typeof e.__c&&e.__c(),V=t}function oe(e){var t=V;e.__c=e.__(),V=t}function le(e,t){return"function"==typeof t?t(e):t}var _e=function(e,t){var n={__c:t="__cC"+h++,__:e,Consumer:function(e,t){return e.children(t)},Provider:function(e,n,r){return this.getChildContext||(n=[],(r={})[t]=this,this.getChildContext=function(){return r},this.shouldComponentUpdate=function(e){this.props.value!==e.value&&n.some(P)},this.sub=function(e){n.push(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){n.splice(n.indexOf(e),1),t&&t.call(e)}}),e.children}};return n.Provider.__=n.Consumer.contextType=n}();function ie(e){var t=e.field,r=e.nolabel,o=e.onChange,_=t.name,i=t.label,u=(t.choices,t.defaultValue,t.value,t.type,l(t,["name","label","choices","defaultValue","value","type"]));function c(e){o(e.target.value)}return w("div",{class:""},!r&&w("label",{class:"capitalize block"},i||_),function(){switch(t.type){case"choice":return w("select",n({required:!t.optional,class:"border-2 w-full px-2 py-1 rounded",defaultValue:t.value,value:t.value,onInput:c},u),w("option",{disabled:!0,value:""},"Choose ",t.name),t.choices.map((function(e){return w("option",{value:e},e)})));case"long-text":return w("textarea",n({required:!t.optional,class:"border-2 w-full px-2 py-1 rounded",placeholder:t.defaultValue,rows:"5",value:t.value,onInput:c},u));default:var e=["text","number","color","range"].includes(t.type)?t.type:"text";return w("input",n({required:!t.optional,class:"border-2 w-full px-2 py-1 rounded",type:e,value:t.value,onInput:c},u))}}())}function ue(e){var t=e.opened,n=void 0!==t&&t,r=e.selectedField,l=e.onSave,i=_(ee(null),2),u=i[0],c=i[1];return function(e,t){var n=Z(R++,3);!a.__s&&function(e,t){return!e||e.length!==t.length||t.some((function(t,n){return t!==e[n]}))}(n.__H,t)&&(n.__=e,n.__H=t,V.__H.__h.push(n))}((function(){c(JSON.parse(JSON.stringify(o({},r))))}),[r]),w("div",{class:"flex fixed inset-0 z-50 ".concat(!n&&"pointer-events-none")},w("div",{className:"bg-black bg-opacity-25 fixed inset-0 transition ".concat(!n&&"opacity-0"),onClick:function(){return l(null)}}),w("div",{class:"m-auto flex flex-col relative z-10 bg-white shadow-lg rounded overflow-hidden transition ".concat(!n&&"opacity-0 transform translate-y-full"),style:"min-width: 500px"},w("div",{class:"py-3 px-4 border-b flex items-center justify-between"},w("h3",{class:"text-lg font-semibold capitalize"},"Edit ",u?u.label||u.type||"Field":""),w("button",{class:"focus:outline-none w-6 h-6 rounded-full p-0 flex items-center justify-center bg-gray-300",onClick:function(){return l(null)}},w("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},w("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})))),w("div",{class:"p-4 flex-1 overflow-y-auto max-h-96"},w("form",{action:"#",onSubmit:function(e){e.preventDefault(),l(u.value)}},u&&w(ie,{field:u,onChange:function(e){console.log("Onchange: ",e),c(o(o({},u),{},{value:e}))}}),w("div",{className:"mt-3 flex justify-end"},w("button",{type:"submit",class:"px-5 py-1 border-2 border-red-500 uppercase text-xs tracking-wide font-semibold bg-red-500 text-white rounded-full"},"Save"))))))}function ce(e){var t=e.articulateRef,n=_(ee(!1),2),r=n[0],l=n[1],i=_(ee(null),2),u=i[0],c=i[1];return t.editField=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){};t.onSaveField=n;var r={optional:!0};c(o(o({},r),e)),setTimeout((function(){l(!0)}))},w(_e.Provider,{value:t},w(ue,{selectedField:u,opened:r,onSave:function(e){t.onSaveField(e),l(!1)}}))}return function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n={},r=t.extend,u=l(t,["extend"]),c=o(o({},n),u),a=0,f=Object.entries(c);a<f.length;a++){var s=_(f[a],2),p=s[0],d=s[1];r&&r[p]?Array.isArray(d)?this[p]=[].concat(i(d),i(r[p])):"object"===e(d)?this[p]=o(o({},d),r[p]):this[p]=d:this[p]=d}var h=document.createElement("div");document.body.appendChild(h),z(w(ce,{articulateRef:this}),h)}}));
